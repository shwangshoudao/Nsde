## 问题

现在的问题是，如何解决几个相关的股票，利用已经训练好的股票的期权定价模型来帮助训练与它相关的期权定价的模型？或者由于期权数据相对有限，如何用几个股票的期权数据训练公有的部分，这在传统的金融定价模型中是很难实现的，我们该如何构造这样一种模型？

## 初步想法

一种想法对于每个股票都有一个模型，但是这个模型中有一部分是公用的，有一部分是单独的，核心想法是，共用的用所有的数据训练，单独的用这支期权单独的数据训练。对于原有的模型
$$
d S_{t}= NN_{1}(S_{t},V_{t},r_{f},t) d t + NN_{2}(S_{t},V_{t},r_{f},t) d B_{1 t} \\
d V_{t}=NN_{3}(S_{t},V_{t},r_{f},t) d t+NN_{4}(S_{t},V_{t},r_{f},t) d B_{2 t},
$$
我们抽象出一个common network的概念，是几个相似股票共享的信息。例如$NN_{1}(S_{t},V_{t},r_{f},t)$ 对应的common network命名为$NN_{1c}(S_{t},V_{t},r_{f},t)$ 。模型改变为下面的模型
$$
d S_{t}= [NN_{1}(S_{t},V_{t},r_{f},t) + NN_{1c}(S_{t},V_{t},r_{f},t)]d t + [NN_{2}(S_{t},V_{t},r_{f},t) + NN_{2c}(S_{t},V_{t},r_{f},t)]d B_{1 t} \\
d V_{t}=[NN_{3}(S_{t},V_{t},r_{f},t) +NN_{3c}(S_{t},V_{t},r_{f},t)]d t+ [NN_{4}(S_{t},V_{t},r_{f},t) +NN_{4c}(S_{t},V_{t},r_{f},t)]d B_{2 t},
$$

## 由此带来的问题

1. 上述的训练怎么实现？（代码层面）
2. 之前的NSDE Pro怎么用到这上面？（相对好解决，理解为每个股票unique的一部分）
3. 怎么衡量这种方法好？比如有了一个苹果的模型，怎么帮助训练亚马逊？或者用了苹果的数据亚马逊的训练的精度更高？



## 可以做的工作

1. 可以单独训练苹果和亚马逊的模型，然后观察两个模型的权重矩阵是不是真的相似，可与某些传统行业进行对比，比如spy，相似可用heatmap可视化权重，或者用一个度量(需查相关资料)
2. 这个训练损失函数怎么具体用代码实现,即下图左边。可以google上查一下关键字看看有没有对应的例子。

![image-20211229172627518](网络共用12.29/image-20211229172627518.png)